// 残りのウィンドウを確認

// 現在の状態
SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\check_remaining.jpg", 0, , , , , , 80)

// まだ存在するかチェック
fid = FOPEN("C:\Users\user\claude-test-100-v0.2\auto-claude-start\remaining_windows.txt", F_WRITE)
FPUT(fid, "=== Remaining Windows Check ===")
FPUT(fid, "")

// ID 15-18をチェック
FOR id = 15 TO 18
    window_exists = (GETID(id) <> -1)
    IF window_exists THEN
        title = STATUS(id, ST_TITLE)
        visible = STATUS(id, ST_VISIBLE)
        FPUT(fid, "ID " + id + ": EXISTS")
        FPUT(fid, "  Title: " + title)
        FPUT(fid, "  Visible: " + visible)
        
        // もし見えないウィンドウなら表示してみる
        IF NOT visible THEN
            CTRLWIN(id, SHOW)
            SLEEP(1)
            SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\show_window_" + id + ".jpg", 0, , , , , , 80)
            CTRLWIN(id, HIDE)  // 元に戻す
        ENDIF
    ELSE
        FPUT(fid, "ID " + id + ": NOT FOUND")
    ENDIF
    FPUT(fid, "")
NEXT

FCLOSE(fid)