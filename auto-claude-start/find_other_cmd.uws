// 他のcmdウィンドウを探す

// ログファイル
fid = FOPEN("C:\Users\user\claude-test-100-v0.2\auto-claude-start\other_cmd_windows.txt", F_WRITE)

// 全ウィンドウ取得
count = GETALLWIN()
FPUT(fid, "=== Searching for other cmd windows ===")
FPUT(fid, "")

// 全てのウィンドウをチェック
FOR i = 0 TO count - 1
    id = ALL_WIN_ID[i]
    IF id > 0 THEN
        title = STATUS(id, ST_TITLE)
        clsname = STATUS(id, ST_CLASS)
        visible = STATUS(id, ST_VISIBLE)
        
        // コンソールウィンドウを探す
        IF (clsname = "ConsoleWindowClass" OR clsname = "PseudoConsoleWindow") AND visible THEN
            pid = STATUS(id, ST_PROCESS)
            
            // 詳細を記録
            FPUT(fid, "Window ID: " + id)
            FPUT(fid, "  PID: " + pid)
            FPUT(fid, "  Title: " + title)
            FPUT(fid, "  Class: " + clsname)
            
            // 私自身のウィンドウかチェック
            IF POS("claude-test-100", title) > 0 THEN
                FPUT(fid, "  *** THIS IS CLAUDE'S WINDOW - DO NOT CLOSE ***")
            ENDIF
            
            FPUT(fid, "")
        ENDIF
    ENDIF
NEXT

FCLOSE(fid)

// 現在の画面状態をキャプチャ
SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\cmd_window_search.jpg", 0, , , , , , 80)