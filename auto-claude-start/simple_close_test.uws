// シンプルに画面の状態を確認してから操作

// 現在の画面状態
SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\current_state.jpg", 0, , , , , , 80)

// Bashで実行中のプロセスを確認
EXEC("cmd.exe /c tasklist | findstr cmd.exe > C:\Users\user\claude-test-100-v0.2\auto-claude-start\cmd_list.txt")
SLEEP(2)

// 画面上の他のcmdウィンドウにフォーカスを移してみる
// 左側のウィンドウにマウスクリック（座標は画面から推測）
MMV(300, 400)  // 左側のcmdウィンドウの位置
BTN(LEFT, CLICK)
SLEEP(1)

// この位置のウィンドウ情報を取得
active_id = GETID(GET_ACTIVE)
active_title = STATUS(active_id, ST_TITLE)

// ログに記録
fid = FOPEN("C:\Users\user\claude-test-100-v0.2\auto-claude-start\window_test.txt", F_WRITE)
FPUT(fid, "Clicked window ID: " + active_id)
FPUT(fid, "Title: " + active_title)
FCLOSE(fid)

// スクリーンショット
SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\after_click.jpg", 0, , , , , , 80)