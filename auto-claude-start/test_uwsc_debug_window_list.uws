// UWSCスクリプト - ウィンドウ一覧取得をデバッグ（エラー時スクショ付き）

// 最初にスクリーンショットを撮る（開始時の状態）
SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\uwsc_debug_before.jpg", 0, , , , , , 70)

// ウィンドウ一覧取得を試みる
TRY
    // ウィンドウ数を取得してみる
    win_count = GETALLWIN()
    
    // ファイルに記録
    fid = FOPEN("C:\Users\user\claude-test-100-v0.2\auto-claude-start\uwsc_debug_log.txt", F_WRITE)
    FPUT(fid, "ウィンドウ数: " + win_count)
    FCLOSE(fid)
    
EXCEPT
    // エラーが発生したらスクリーンショットを撮る
    SLEEP(1)
    SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\uwsc_debug_error.jpg", 0, , , , , , 70)
ENDTRY

// 最後にもスクリーンショット（完了時の状態）
SAVEIMG("C:\Users\user\claude-test-100-v0.2\auto-claude-start\uwsc_debug_after.jpg", 0, , , , , , 70)