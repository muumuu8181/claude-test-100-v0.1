// UWSCスクリプト - キーボード入力テスト（修正版）
// PowerShellウィンドウに正しく文字入力を行う

// PowerShellウィンドウを探す
ps_id = GETID("Windows PowerShell", "ConsoleWindowClass")
IF ps_id = 0 THEN
    ps_id = GETID("PowerShell", "CASCADIA_HOSTING_WINDOW_CLASS")
ENDIF

// ウィンドウが見つからない場合は終了
IF ps_id = 0 THEN
    PRINT "PowerShellウィンドウが見つかりません"
    EXIT
ENDIF

// ウィンドウをアクティブにする
CTRLWIN(ps_id, ACTIVATE)
SLEEP(0.5)

// 正しい方法：特定のウィンドウIDに文字列を送信
SENDSTR(ps_id, "Hello")
SLEEP(0.5)

// Enterキーを送信
SCKEY(ps_id, VK_RETURN)
SLEEP(0.5)

SENDSTR(ps_id, "echo Test successful")
SLEEP(0.5)
SCKEY(ps_id, VK_RETURN)

PRINT "文字入力完了: PowerShell ID=" + ps_id